<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Let's Build Course Software: Deployment</title>
        <!-- <meta name="description" content=""> -->
        <link rel="canonical" href="/posts/series-build-coding-course-deployment/">

    <!-- Site Favicon -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/png" />

    <!-- Font Embed Code -->
    <link href="https://fonts.googleapis.com/css?family=Karla:400,400i,700,700i" rel="stylesheet" />

    <!-- CSS Styles -->
    <link href="/css/style.css" rel="stylesheet">
    <link href="/css/monokai.css" rel="stylesheet"> <!-- Pygments code highlighting -->
    <link href="/css/site.css" rel="stylesheet">
    <link href="/css/simple-lightbox.min.css" rel="stylesheet">

</head>

<body> <!-- class="layout-default" -->
    <div id="page" class="site">
        <header id="masthead" class="site-header outer">
    <div class="site-header-inside">
        <div class="site-branding">
            <p class="site-logo"><a href="https://codefol.io/" rel="home"><img src="/images/codefolio_book_transparent_160_102.png" alt="Codefol.io book logo" /></a></p>
            <h1 class="site-title screen-reader-text"><a href="https://codefol.io" rel="home">Codefol.io</a></h1>
        </div><!-- .site-branding -->
        <nav id="main-navigation" class="site-navigation" aria-label="Primary Navigation">
            <ul class="menu">
                <li class="menu-item"><a href="/posts">All Articles</a></li>
                <li class="menu-item"><a href="/topics">Articles by Topic</a></li>
                <li class="menu-item"><a href="/tags/favourite">Favourite Articles</a></li>
                <li class="menu-item"><a href="/feed.xml">RSS</a></li>
                <li class="menu-item"><a href="/about">About</a></li>
            </ul>
        </nav><!-- .site-navigation -->
    </div><!-- .site-header-inside -->
</header><!-- .site-header -->

        

<div id="content" class="site-content">
    <main id="main" class="site-main outer">
        <article class="post-full inner">
            <header class="post-header">
                <h1 class="posttitle">Let's Build Course Software: Deployment</h1>
            </header><!-- .post-header -->
            <div class="post-content">
                  
<figure class="aside-right">
    <div  >
      <img src="/img/RadioRepair_aside_216_162.png" class="d-none d-md-block" alt="A chalk figure kneeling to repair (possibly) a radio." width='216' height='162' title='How Hard Can it Be?' />
    </div>

      <figcaption class="caption-text">
        How Hard Can it Be?
        
        
      </figcaption>
</figure>

                <p>You can learn a lot about how much a man fears something by seeing what he will do to procrastinate instead of doing it. Paul Graham talks about &ldquo;sneaking&rdquo; out to get a root canal, feeling like he was getting away with it, to avoid a board meeting of his first startup.</p>

<p>I talked last time about how much I dreaded writing email reminders.</p>

<p>So for this post: deployment.</p>

<p>(What if you don&rsquo;t want to read about deployment for fun? That&rsquo;s fair. But I ask you, do you want to read about <strong><em>somebody else&rsquo;s pain doing deployment instead of you</em></strong> for fun? Because I think that has possibilities.)</p>

<h2>Ops and Deployment</h2>

<figure class="aside-right">
    <a class='lightboxed' href='&#x2F;posts&#x2F;series-build-coding-course-real-teaching&#x2F;rms_with_videos.png' >
      <img src="&#x2F;posts&#x2F;series-build-coding-course-real-teaching&#x2F;rms_with_videos.png" class="img-frame" alt="Several steps in a code-teaching topic, including text and videos."   title="The app we&#x27;re deploying." />
    </a>
        <figcaption class="caption-text">The app we&rsquo;re deploying.</figcaption> 
</figure>

<p>I&rsquo;ve worked on a team with Operations folks professionally. I&rsquo;ve also managed a team containing Ops folks. Both are excellent experiences and I recommend them highly. The Ops mindset is <a href="/posts/water-we-swim-in-software-developer-mindset/">very different from the usual Software Dev mindset</a>.</p>

<p><a href="https://codefol.io/posts/deployment-versus-provisioning-versus-orchestration/">Provisioning</a> a host (getting it set up with libraries, tools and so on) is pretty solidly Operations work. Writing your app is Software Dev.</p>

<p>Deployment is that uncomfortable middle ground where they meet and both sides would really rather have the other side do it, thanks. Operations (or DevOps) is usually less politically powerful in the company and winds up having to do it, but not always.</p>

<p>Of course if you work by yourself like I do, you&rsquo;re Developer and Ops/DevOps all in one. I <strong><em>always</em></strong> lose that power struggle (and I also always win it.)</p>

<h2>Tools and Starting Points</h2>

<p>There&rsquo;s plenty of competition between various provisioning and deployment tools. <a href="https://www.chef.io">Chef</a> and <a href="https://puppet.com">Puppet</a> and <a href="https://www.ansible.com">Ansible</a> and <a href="https://saltstack.com">Salt</a> for provisioning new hosts and keeping them up-to-date, <a href="https://capistranorb.com">Capistrano</a> and <a href="https://github.com/mina-deploy/mina">Mina</a> and heck, just plain ssh-and-git-pull for deploying your app, plus shell scripts everywhere for absolutely everything&hellip;</p>

<p>I&rsquo;ve worked with a lot of different tools and my needs are simple, so I Googled around to find something that was pretty close to what I needed. <a href="https://github.com/EmailThis/ansible-rails">ansible-rails from EmailThis</a> had fairly recent commits, was a basically similar setup to what I wanted and didn&rsquo;t seem like it would need too much extra customisation. Better, it had a nice Vagrant setup for local debugging but could be adapted to push to a production environment afterward.</p>

<p>Couldn&rsquo;t I find something that was a straight-up tool that could just be adapted, and my site would just be a little bit of configuration on top? Not really, no. That&rsquo;s the dream. But <a href="http://codefol.io/posts/why-i-shut-down-rails-deploy-in-an-hour/">I&rsquo;ve learned the hard way</a> how difficult it is to make it, and keep it, a reality. If you want genuinely simple deployment, spend a little cash on a paid service like Heroku.</p>

<p>Could I do that? Possibly. This app isn&rsquo;t likely to make me any money so I&rsquo;m loathe to spend much. And I had an existing tangle of bespoke one-off deployment that I had no ability to recreate that I wanted to turn into something better. Disk images and backups are okay, but it&rsquo;s better to be able to rebuild on top of, say, a more recent Ubuntu when you need to.</p>

<p>And so <a href="https://github.com/noahgibbs/ansible-codefolio">I forked ansible-rails</a>, <a href="https://github.com/noahgibbs/ansible-codefolio/commit/4b87b5deedc66f8076cec970f5e474360dfa26d4">started adapting it</a> <a href="https://github.com/noahgibbs/ansible-codefolio/commit/1d8fcbba002651669b8b0f1bea6730dcdf744f66">to my own setup</a>, and <a href="https://github.com/noahgibbs/ansible-codefolio/commit/218a4119d750e3427c0537704324b2c39d2102b4">began updating and fixing</a> more generally. It turns out deployment bakes in a lot of assumptions that need little fixes all over.</p>

<p>This was also my first time deploying a Rails 6 app, and my first time working with Ansible. Both were pretty okay.</p>

<h2>Local Debugging and Vagrant Setup</h2>

<p>I love being able to test provisioning with <a href="https://www.vagrantup.com/">Vagrant</a> and a local virtual machine. It&rsquo;s cheap! And it can&rsquo;t break production!</p>

<p>It also can&rsquo;t get LetsEncrypt certificates and has trouble with HTTPS setup in general. Plus I do this thing where one machine hosts all my domains, and so if my URL starts with http://192.168.50.2, it has no idea which web site I think I&rsquo;m trying to look at.</p>

<p>People who do this a lot (Ops-types? Masochists? Masochistic ops-types?) already know these workarounds. For instance, I can add extra fake entries to my /private/etc/hosts on MacOS (just /etc/hosts on Linux):</p>
<div class="highlight"><pre class="highlight plaintext"><code>192.168.50.2    codefol.io.localdev
192.168.50.2    mst_site.localdev
192.168.50.2    rubymadscience.localdev
192.168.50.2    www_static.localdev
192.168.50.2    rr_site.localdev
</code></pre></div>
<p>Now I have a bunch of domain names that don&rsquo;t exist in the outside world, but they all forward to my local Vagrant private IP address. There are similar tricks you can do with external services where you can put where you want them to resolve right in the domain name, then put that fake domain in your NGinX config.</p>

<p>Both solutions are kind of gross. I favour this one.</p>

<p>You might ask, &ldquo;how and why does this work?&rdquo; The answer is that since HTTP 1.1, your HTTP request includes the full URL it&rsquo;s looking for, including the hostname, right inside the request itself. So when your browser makes that request it can include the fake hostname you gave it. Then NGinX, running on your vagrant VM, can see the fake hostname you typed into the browser URL bar. If you had instead typed &ldquo;http://192.168.50.2&rdquo; then it couldn&rsquo;t do that. Or rather, it <strong><em>would</em></strong> do that, but the host would just be called &ldquo;192.168.50.2&rdquo;. That doesn&rsquo;t help much.</p>

<p>Incidentally, as I complain about HTTPS some of you are mouthing the words &ldquo;self-signed certificate&rdquo; under your breath. That makes sense &mdash; swearing helps reduce your frustration.</p>

<p>But seriously - in that &ldquo;gross solutions&rdquo; tradeoff, I&rsquo;d rather do most of my debugging with http than go through and turn off all the HTTPS security checks (for instance, on any REST request to my own server) so that my tools work in dev. I feel like just <em>not</em> using HTTPS for development has a lower probability of me sabotaging important HTTPS checks in a way that will deploy them to production. HTTPS where you don&rsquo;t require certificate verification is&hellip; problematic. And getting my self-signed certificate into all the places it needs to go (browser, various tools) is hard, error-prone, and breaks every few versions of the browser and/or OS.</p>

<p>On the plus side I don&rsquo;t plan to keep debugging on a VM for long. And debugging <em>deployment</em> on a VM, while it&rsquo;s not fun, is much better than doing it anywhere near production.</p>

<h2>That Jarring Jump from Testing to Reality</h2>

<figure class="aside-right">
    <a class='lightboxed' href='&#x2F;posts&#x2F;series-build-coding-course-deployment&#x2F;rails_generic_error_page.png' >
      <img src="&#x2F;posts&#x2F;series-build-coding-course-deployment&#x2F;rails_generic_error_page.png" class="img-frame" alt="A web page with a single dialog box saying &#x27;Sorry, but something went wrong&#x27; and that the application owner should check the logs for more information."   title="This doesn&#x27;t have to come from Rails at all. It may not leave any logs." />
    </a>
        <figcaption class="caption-text">This doesn&rsquo;t have to come from Rails at all. It may not leave any logs.</figcaption> 
</figure>

<p>I won&rsquo;t make you sit through a blow-by-blow of the various problems I found and fixed or worked around. Instead, here&rsquo;s just the most interesting one:</p>

<p>If you&rsquo;re getting a generic Rails error page telling you to check the logs? That doesn&rsquo;t necessarily mean the Rails logs, because you may not be hitting Rails at all. Instead, that could be NGinX returning the (Rails-flavoured) 500 error page from your app because NGinX can&rsquo;t connect with Rails &mdash; for instance, because your application and your web server don&rsquo;t agree on the location of Puma&rsquo;s Unix socket and can&rsquo;t talk to each other at all. Puma could also be dead or not running and you&rsquo;d see the same.</p>

<p>But having done that, <strong><em>it&rsquo;s time to actually put this on a server.</em></strong> I assume everybody else also gets nervous when it&rsquo;s time to spend money to get another server running, even before the (terrifying) prod switchover where you could break everything and not be able to get it working again.</p>

<p>But, y&#39;know, no pressure.</p>

<p>I use Linode for my <a href="https://en.wikipedia.org/wiki/Virtual_private_server">VPS hosting</a>. They&rsquo;re pretty good. Now that things work locally, it&rsquo;s time for a new VPS instance.</p>

<h2>Reality</h2>

<p>DNS is always weird when you&rsquo;re changing servers. It can take hours to propagate, or occasionally longer, and you won&rsquo;t necessarily see the same things your users do. In this case, I&rsquo;m at least switching over domains that are basically disused. So if there&rsquo;s some difficulty, it&rsquo;s not a huge deal.</p>

<p>I move the &ldquo;new&rdquo; domain (RubyMadScience.com) over to the new instance, along with a couple of domains I don&rsquo;t really use and that just sit around (angelbob.com, MadRubyScience.com).</p>

<p>I separate out the first couple of deploy steps into their own YAML file with just the first roles. That&rsquo;s important - I can only connect using the deploy user once that user exists.</p>

<p>Bizarrely, inexplicably, when I point Ansible at the new host and run the pre-provisioning step, it works fine. Even more weirdly, the deployment step following that is fine too. Even the deployment step that copies the app into place works.</p>

<p>No clue if it&rsquo;s <em>actually</em> working, obviously. DNS takes forever to change over. Though actually, I can use a similar trick with hosts above to try out the new deployment:</p>
<div class="highlight"><pre class="highlight plaintext"><code>104.237.154.219 codefol.io.staging
104.237.154.219 mst_site.staging
104.237.154.219 rubymadscience.staging
104.237.154.219 www_static.staging
104.237.154.219 rr_site.staging
104.237.154.219 angelbob.com.staging
</code></pre></div>
<p>And&hellip; Everything shows up as the default site. Okay, so I add these new URLs to my list of URLs and&hellip;</p>

<p>Nope. Even after running all the deployment and provisioning code again.</p>

<p>Ah, okay. <strong><em>Now</em></strong> I believe it&rsquo;s deployment code.</p>

<p>I SSH into the new host and it seems like for whatever reason, Ansible isn&rsquo;t updating the template block that creates all the NGinX files. Ten minutes later, it turns out I had another place I <strong><em>also</em></strong> kept URLs and I hadn&rsquo;t updated both. <a href="https://www.computerhope.com/jargon/p/pebkac.htm">PEBKAC</a>, as you might expect.</p>

<p>Oh, and the shared puma.rb config file is being replaced with some kind of weird YAML for no obvious reason. Running the deploy again fixed it (???), which suggests there&rsquo;s some kid of a race condition or something that destroys the file that I haven&rsquo;t caught yet. I suppose I&rsquo;ll watch for it&hellip;</p>

<h2>Finality</h2>

<figure class="aside-right">
    <a class='lightboxed' href='&#x2F;posts&#x2F;series-build-coding-course-deployment&#x2F;rms_deployed.png' >
      <img src="&#x2F;posts&#x2F;series-build-coding-course-deployment&#x2F;rms_deployed.png" class="img-frame" alt="Several steps in a code-teaching topic, including text and videos."   title="The app we&#x27;ve just deployed." />
    </a>
        <figcaption class="caption-text">The app we&rsquo;ve just deployed.</figcaption> 
</figure>

<p>And that, at last, is working. I&rsquo;m sure I&rsquo;ll find small details to fix, but that&rsquo;s a fine start.</p>

<p>That means there&rsquo;s a decent chance that the app, in unfinished form is <a href="https://rubymadscience.com">sitting right there at the URL right now</a> if you feel like looking around. You could even make a Devise-standard account. Maybe I should make those views slightly less&hellip; um&hellip; accidental-looking.</p>

<p>Want to see more about Ruby Mad Science as it happens? You can check <a href="/tags/rubymadscience">the rubymadscience tag on this blog</a>, including not-yet-published ones. There’s also an RSS feed of posts at the top, or you can subscribe to my email list below. I’ll definitely email the list with these posts.</p>

<p>Or if you’ve bought one of my books, you get to read and discuss blog posts early with my readers as I finish them, in the #prerelease-blog-posts channel of the customer Slack.</p>

            </div>
            <footer class="post-footer">
                <div class="post-meta">
                    <time class="post-date" datetime="2020-07-03">Jul  3 2020</time>
                </div><!-- .post-meta -->
                <div class="post-tags">
                        <a href='/tags/ruby/'>ruby</a>
                        <a href='/tags/rails/'>rails</a>
                        <a href='/tags/letsbuild/'>letsbuild</a>
                        <a href='/tags/rubymadscience/'>rubymadscience</a>
                </div>
            </footer>
        </article>
        <section id="bottom-newsletter-box" class="newsletter-box inner-wide">
    <div class="inner">
        <h2 class="newsletter-box-title">You Hunger to Get Better</h2>
        <p>
            Subscribe to get free ebook chapters and an emailed coding class now, plus videos and articles a few times a month.
        </p>
        <p>
            Why this specific newsletter? <i><b>You want to be an expert</b></i>. Expertise comes from learning the fundamentals, deeply. And that comes from the best kind of practice.
            I write with that in mind. I won't waste your time.
        </p>
        <p>
            (Yes, I also sell things. They're good, but I'm fine if you don't buy them.)
        </p>
        <!-- Begin ActiveCampaign Signup Form -->
<style>
 #_form_1_ { font-size:14px; line-height:1.6; font-family:arial, helvetica, sans-serif; margin:0; }
 #_form_1_ * { outline:0; }
 ._form_hide { display:none; visibility:hidden; }
 ._form_show { display:block; visibility:visible; }
 #_form_1_._form-top { top:0; }
 #_form_1_._form-bottom { bottom:0; }
 #_form_1_._form-left { left:0; }
 #_form_1_._form-right { right:0; }
 #_form_1_ input[type="text"],#_form_1_ input[type="date"],#_form_1_ textarea { padding:6px; height:auto; border:#979797 1px solid; border-radius:4px; color:#000 !important; font-size:14px; -webkit-box-sizing:border-box; -moz-box-sizing:border-box; box-sizing:border-box; }
 #_form_1_ textarea { resize:none; }
 #_form_1_ ._submit { -webkit-appearance:none; cursor:pointer; font-family:arial, sans-serif; font-size:14px; text-align:center; background:#004cff !important; border:0 !important; -moz-border-radius:10px !important; -webkit-border-radius:10px !important; border-radius:10px !important; color:#fff !important; padding:10px !important; }
 #_form_1_ ._close-icon { cursor:pointer; background-image:url('https://d226aj4ao1t61q.cloudfront.net/esfkyjh1u_forms-close-dark.png'); background-repeat:no-repeat; background-size:14.2px 14.2px; position:absolute; display:block; top:11px; right:9px; overflow:hidden; width:16.2px; height:16.2px; }
 #_form_1_ ._close-icon:before { position:relative; }
 #_form_1_ ._form-body { margin-bottom:30px; }
 #_form_1_ ._form-image-left { width:150px; float:left; }
 #_form_1_ ._form-content-right { margin-left:164px; }
 #_form_1_ ._form-branding { color:#fff; font-size:10px; clear:both; text-align:left; margin-top:30px; font-weight:100; }
 #_form_1_ ._form-branding ._logo { display:block; width:130px; height:14px; margin-top:6px; background-image:url('https://d226aj4ao1t61q.cloudfront.net/hh9ujqgv5_aclogo_li.png'); background-size:130px auto; background-repeat:no-repeat; }
 #_form_1_ .form-sr-only { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0, 0, 0, 0); border:0; }
 #_form_1_ ._form-label,#_form_1_ ._form_element ._form-label { font-weight:bold; margin-bottom:5px; display:block; }
 #_form_1_._dark ._form-branding { color:#333; }
 #_form_1_._dark ._form-branding ._logo { background-image:url('https://d226aj4ao1t61q.cloudfront.net/jftq2c8s_aclogo_dk.png'); }
 #_form_1_ ._form_element { position:relative; margin-bottom:10px; font-size:0; max-width:100%; }
 #_form_1_ ._form_element * { font-size:14px; }
 #_form_1_ ._form_element._clear { clear:both; width:100%; float:none; }
 #_form_1_ ._form_element._clear:after { clear:left; }
 #_form_1_ ._form_element input[type="text"],#_form_1_ ._form_element input[type="date"],#_form_1_ ._form_element select,#_form_1_ ._form_element textarea:not(.g-recaptcha-response) { display:block; width:100%; -webkit-box-sizing:border-box; -moz-box-sizing:border-box; box-sizing:border-box; font-family:inherit; }
 #_form_1_ ._field-wrapper { position:relative; }
 #_form_1_ ._inline-style { float:left; }
 #_form_1_ ._inline-style input[type="text"] { width:150px; }
 #_form_1_ ._inline-style:not(._clear) + ._inline-style:not(._clear) { margin-left:20px; }
 #_form_1_ ._form_element img._form-image { max-width:100%; }
 #_form_1_ ._form_element ._form-fieldset { border:0; padding:0.01em 0 0 0; margin:0; min-width:0; }
 #_form_1_ ._clear-element { clear:left; }
 #_form_1_ ._full_width { width:100%; }
 #_form_1_ ._form_full_field { display:block; width:100%; margin-bottom:10px; }
 #_form_1_ input[type="text"]._has_error,#_form_1_ textarea._has_error { border:#f37c7b 1px solid; }
 #_form_1_ input[type="checkbox"]._has_error { outline:#f37c7b 1px solid; }
 #_form_1_ ._error { display:block; position:absolute; font-size:14px; z-index:10000001; }
 #_form_1_ ._error._above { padding-bottom:4px; bottom:39px; right:0; }
 #_form_1_ ._error._below { padding-top:4px; top:100%; right:0; }
 #_form_1_ ._error._above ._error-arrow { bottom:0; right:15px; border-left:5px solid transparent; border-right:5px solid transparent; border-top:5px solid #f37c7b; }
 #_form_1_ ._error._below ._error-arrow { top:0; right:15px; border-left:5px solid transparent; border-right:5px solid transparent; border-bottom:5px solid #f37c7b; }
 #_form_1_ ._error-inner { padding:8px 12px; background-color:#f37c7b; font-size:14px; font-family:arial, sans-serif; color:#fff; text-align:center; text-decoration:none; -webkit-border-radius:4px; -moz-border-radius:4px; border-radius:4px; }
 #_form_1_ ._error-inner._form_error { margin-bottom:5px; text-align:left; }
 #_form_1_ ._button-wrapper ._error-inner._form_error { position:static; }
 #_form_1_ ._error-inner._no_arrow { margin-bottom:10px; }
 #_form_1_ ._error-arrow { position:absolute; width:0; height:0; }
 #_form_1_ ._error-html { margin-bottom:10px; }
 .pika-single { z-index:10000001 !important; }
 #_form_1_ input[type="text"].datetime_date { width:69%; display:inline; }
 #_form_1_ select.datetime_time { width:29%; display:inline; height:32px; }
 #_form_1_ input[type="date"].datetime_date { width:69%; display:inline-flex; }
 #_form_1_ input[type="time"].datetime_time { width:29%; display:inline-flex; }
 @media all and (min-width:320px) and (max-width:667px) { ::-webkit-scrollbar { display:none; }
 #_form_1_ { margin:0; width:100%; min-width:100%; max-width:100%; box-sizing:border-box; }
 #_form_1_ * { -webkit-box-sizing:border-box; -moz-box-sizing:border-box; box-sizing:border-box; font-size:1em; }
 #_form_1_ ._form-content { margin:0; width:100%; }
 #_form_1_ ._form-inner { display:block; min-width:100%; }
 #_form_1_ ._form-title,#_form_1_ ._inline-style { margin-top:0; margin-right:0; margin-left:0; }
 #_form_1_ ._form-title { font-size:1.2em; }
 #_form_1_ ._form_element { margin:0 0 20px; padding:0; width:100%; }
 #_form_1_ ._form-element,#_form_1_ ._inline-style,#_form_1_ input[type="text"],#_form_1_ label,#_form_1_ p,#_form_1_ textarea:not(.g-recaptcha-response) { float:none; display:block; width:100%; }
 #_form_1_ ._row._checkbox-radio label { display:inline; }
 #_form_1_ ._row,#_form_1_ p,#_form_1_ label { margin-bottom:0.7em; width:100%; }
 #_form_1_ ._row input[type="checkbox"],#_form_1_ ._row input[type="radio"] { margin:0 !important; vertical-align:middle !important; }
 #_form_1_ ._row input[type="checkbox"] + span label { display:inline; }
 #_form_1_ ._row span label { margin:0 !important; width:initial !important; vertical-align:middle !important; }
 #_form_1_ ._form-image { max-width:100%; height:auto !important; }
 #_form_1_ input[type="text"] { padding-left:10px; padding-right:10px; font-size:16px; line-height:1.3em; -webkit-appearance:none; }
 #_form_1_ input[type="radio"],#_form_1_ input[type="checkbox"] { display:inline-block; width:1.3em; height:1.3em; font-size:1em; margin:0 0.3em 0 0; vertical-align:baseline; }
 #_form_1_ button[type="submit"] { padding:20px; font-size:1.5em; }
 #_form_1_ ._inline-style { margin:20px 0 0 !important; }
 }
 #_form_1_ { position:relative; text-align:left; margin:25px auto 0; padding:20px; -webkit-box-sizing:border-box; -moz-box-sizing:border-box; box-sizing:border-box; *zoom:1; background:#fff !important; border:0px solid #b0b0b0 !important; max-width:500px; -moz-border-radius:0px !important; -webkit-border-radius:0px !important; border-radius:0px !important; color:#000 !important; }
 #_form_1_._inline-form,#_form_1_._inline-form ._form-content,#_form_1_._inline-form input,#_form_1_._inline-form ._submit { font-family:"IBM Plex Sans", Helvetica, sans-serif, 'IBM Plex Sans', arial, sans-serif; }
 #_form_1_ ._form-title { font-size:22px; line-height:22px; font-weight:600; margin-bottom:0; }
 #_form_1_:before,#_form_1_:after { content:" "; display:table; }
 #_form_1_:after { clear:both; }
 #_form_1_._inline-style { width:auto; display:inline-block; }
 #_form_1_._inline-style input[type="text"],#_form_1_._inline-style input[type="date"] { padding:10px 12px; }
 #_form_1_._inline-style button._inline-style { position:relative; top:27px; }
 #_form_1_._inline-style p { margin:0; }
 #_form_1_._inline-style ._button-wrapper { position:relative; margin:27px 12.5px 0 20px; }
 #_form_1_ ._form-thank-you { position:relative; left:0; right:0; text-align:center; font-size:18px; }
 @media all and (min-width:320px) and (max-width:667px) { #_form_1_._inline-form._inline-style ._inline-style._button-wrapper { margin-top:20px !important; margin-left:0 !important; }
 }
</style>
<link href="https://fonts.googleapis.com/css2?family=Lato&family=Montserrat&family=Roboto&display=swap" rel="stylesheet">
  <form method="POST" action="https://thecodefolioguy.activehosted.com/proc.php" id="_form_1_" class="_form _form_1 _inline-form  _dark" novalidate>
    <input type="hidden" name="u" value="1" />
    <input type="hidden" name="f" value="1" />
    <input type="hidden" name="s" />
    <input type="hidden" name="c" value="0" />
    <input type="hidden" name="m" value="0" />
    <input type="hidden" name="act" value="sub" />
    <input type="hidden" name="v" value="2" />
    <input type="hidden" name="or" value="b32f143a691c8dfcc1838e20ce69bab4" />
    <div class="_form-content">
      <div class="_form_element _x76866041 _full_width _clear" >
        <div class="_form-title">
          Subscribe for an Email Class, Free Chapters and Articles
        </div>
      </div>
      <div class="_form_element _x66338756 _full_width _clear" >
        <div class="_html-code">
          <p>
            Your welcome message will contain download links.
          </p>
        </div>
      </div>
      <div class="_form_element _x14249554 _full_width " >
        <label for="fullname" class="_form-label">
          Full Name
        </label>
        <div class="_field-wrapper">
          <input type="text" id="fullname" name="fullname" placeholder="Type your name" />
        </div>
        <!--  This STARTS the Custom Objects section  -->
        </div>
        <div class="_form_element _x74061491 _full_width " >
          <label for="email" class="_form-label">
            Email*
          </label>
          <div class="_field-wrapper">
            <input type="text" id="email" name="email" placeholder="Type your email" required/>
          </div>
          <!--  This STARTS the Custom Objects section  -->
          </div>
          <div class="_button-wrapper _full_width">
            <button id="_form_1_submit" class="_submit" type="submit">
              Submit
            </button>
          </div>
          <div class="_clear-element">
          </div>
        </div>
        <div class="_form-thank-you" style="display:none;">
        </div>
      </form><script type="text/javascript">
window.cfields = [];
window._show_thank_you = function(id, message, trackcmp_url, email) {
  var form = document.getElementById('_form_' + id + '_'), thank_you = form.querySelector('._form-thank-you');
  form.querySelector('._form-content').style.display = 'none';
  thank_you.innerHTML = message;
  thank_you.style.display = 'block';
  const vgoAlias = typeof visitorGlobalObjectAlias === 'undefined' ? 'vgo' : visitorGlobalObjectAlias;
  var visitorObject = window[vgoAlias];
  if (email && typeof visitorObject !== 'undefined') {
    visitorObject('setEmail', email);
    visitorObject('update');
  } else if (typeof(trackcmp_url) != 'undefined' && trackcmp_url) {
    // Site tracking URL to use after inline form submission.
    _load_script(trackcmp_url);
  }
  if (typeof window._form_callback !== 'undefined') window._form_callback(id);
};
window._show_error = function(id, message, html) {
  var form = document.getElementById('_form_' + id + '_'), err = document.createElement('div'), button = form.querySelector('button'), old_error = form.querySelector('._form_error');
  if (old_error) old_error.parentNode.removeChild(old_error);
  err.innerHTML = message;
  err.className = '_error-inner _form_error _no_arrow';
  var wrapper = document.createElement('div');
  wrapper.className = '_form-inner';
  wrapper.appendChild(err);
  button.parentNode.insertBefore(wrapper, button);
  document.querySelector('[id^="_form"][id$="_submit"]').disabled = false;
  if (html) {
    var div = document.createElement('div');
    div.className = '_error-html';
    div.innerHTML = html;
    err.appendChild(div);
  }
};
window._load_script = function(url, callback) {
  var head = document.querySelector('head'), script = document.createElement('script'), r = false;
  script.type = 'text/javascript';
  script.charset = 'utf-8';
  script.src = url;
  if (callback) {
    script.onload = script.onreadystatechange = function() {
      if (!r && (!this.readyState || this.readyState == 'complete')) {
        r = true;
        callback();
      }
    };
  }
  head.appendChild(script);
};
(function() {
  if (window.location.search.search("excludeform") !== -1) return false;
  var getCookie = function(name) {
    var match = document.cookie.match(new RegExp('(^|; )' + name + '=([^;]+)'));
    return match ? match[2] : null;
  }
  var setCookie = function(name, value) {
    var now = new Date();
    var time = now.getTime();
    var expireTime = time + 1000 * 60 * 60 * 24 * 365;
    now.setTime(expireTime);
    document.cookie = name + '=' + value + '; expires=' + now + ';path=/';
  }
      var addEvent = function(element, event, func) {
    if (element.addEventListener) {
      element.addEventListener(event, func);
    } else {
      var oldFunc = element['on' + event];
      element['on' + event] = function() {
        oldFunc.apply(this, arguments);
        func.apply(this, arguments);
      };
    }
  }
  var _removed = false;
  var form_to_submit = document.getElementById('_form_1_');
  var allInputs = form_to_submit.querySelectorAll('input, select, textarea'), tooltips = [], submitted = false;

  var getUrlParam = function(name) {
    var params = new URLSearchParams(window.location.search);
    return params.get(name) || false;
  };

  for (var i = 0; i < allInputs.length; i++) {
    var regexStr = "field\\[(\\d+)\\]";
    var results = new RegExp(regexStr).exec(allInputs[i].name);
    if (results != undefined) {
      allInputs[i].dataset.name = window.cfields[results[1]];
    } else {
      allInputs[i].dataset.name = allInputs[i].name;
    }
    var fieldVal = getUrlParam(allInputs[i].dataset.name);

    if (fieldVal) {
      if (allInputs[i].dataset.autofill === "false") {
        continue;
      }
      if (allInputs[i].type == "radio" || allInputs[i].type == "checkbox") {
        if (allInputs[i].value == fieldVal) {
          allInputs[i].checked = true;
        }
      } else {
        allInputs[i].value = fieldVal;
      }
    }
  }

  var remove_tooltips = function() {
    for (var i = 0; i < tooltips.length; i++) {
      tooltips[i].tip.parentNode.removeChild(tooltips[i].tip);
    }
    tooltips = [];
  };
  var remove_tooltip = function(elem) {
    for (var i = 0; i < tooltips.length; i++) {
      if (tooltips[i].elem === elem) {
        tooltips[i].tip.parentNode.removeChild(tooltips[i].tip);
        tooltips.splice(i, 1);
        return;
      }
    }
  };
  var create_tooltip = function(elem, text) {
    var tooltip = document.createElement('div'), arrow = document.createElement('div'), inner = document.createElement('div'), new_tooltip = {};
    if (elem.type != 'radio' && elem.type != 'checkbox') {
      tooltip.className = '_error';
      arrow.className = '_error-arrow';
      inner.className = '_error-inner';
      inner.innerHTML = text;
      tooltip.appendChild(arrow);
      tooltip.appendChild(inner);
      elem.parentNode.appendChild(tooltip);
    } else {
      tooltip.className = '_error-inner _no_arrow';
      tooltip.innerHTML = text;
      elem.parentNode.insertBefore(tooltip, elem);
      new_tooltip.no_arrow = true;
    }
    new_tooltip.tip = tooltip;
    new_tooltip.elem = elem;
    tooltips.push(new_tooltip);
    return new_tooltip;
  };
  var resize_tooltip = function(tooltip) {
    var rect = tooltip.elem.getBoundingClientRect();
    var doc = document.documentElement, scrollPosition = rect.top - ((window.pageYOffset || doc.scrollTop)  - (doc.clientTop || 0));
    if (scrollPosition < 40) {
      tooltip.tip.className = tooltip.tip.className.replace(/ ?(_above|_below) ?/g, '') + ' _below';
    } else {
      tooltip.tip.className = tooltip.tip.className.replace(/ ?(_above|_below) ?/g, '') + ' _above';
    }
  };
  var resize_tooltips = function() {
    if (_removed) return;
    for (var i = 0; i < tooltips.length; i++) {
      if (!tooltips[i].no_arrow) resize_tooltip(tooltips[i]);
    }
  };
  var validate_field = function(elem, remove) {
    var tooltip = null, value = elem.value, no_error = true;
    remove ? remove_tooltip(elem) : false;
    if (elem.type != 'checkbox') elem.className = elem.className.replace(/ ?_has_error ?/g, '');
    if (elem.getAttribute('required') !== null) {
      if (elem.type == 'radio' || (elem.type == 'checkbox' && /any/.test(elem.className))) {
        var elems = form_to_submit.elements[elem.name];
        if (!(elems instanceof NodeList || elems instanceof HTMLCollection) || elems.length <= 1) {
          no_error = elem.checked;
        }
        else {
          no_error = false;
          for (var i = 0; i < elems.length; i++) {
            if (elems[i].checked) no_error = true;
          }
        }
        if (!no_error) {
          tooltip = create_tooltip(elem, "Please select an option.");
        }
      } else if (elem.type =='checkbox') {
        var elems = form_to_submit.elements[elem.name], found = false, err = [];
        no_error = true;
        for (var i = 0; i < elems.length; i++) {
          if (elems[i].getAttribute('required') === null) continue;
          if (!found && elems[i] !== elem) return true;
          found = true;
          elems[i].className = elems[i].className.replace(/ ?_has_error ?/g, '');
          if (!elems[i].checked) {
            no_error = false;
            elems[i].className = elems[i].className + ' _has_error';
            err.push("Checking %s is required".replace("%s", elems[i].value));
          }
        }
        if (!no_error) {
          tooltip = create_tooltip(elem, err.join('<br/>'));
        }
      } else if (elem.tagName == 'SELECT') {
        var selected = true;
        if (elem.multiple) {
          selected = false;
          for (var i = 0; i < elem.options.length; i++) {
            if (elem.options[i].selected) {
              selected = true;
              break;
            }
          }
        } else {
          for (var i = 0; i < elem.options.length; i++) {
            if (elem.options[i].selected && (!elem.options[i].value || (elem.options[i].value.match(/\n/g)))) {
              selected = false;
            }
          }
        }
        if (!selected) {
          elem.className = elem.className + ' _has_error';
          no_error = false;
          tooltip = create_tooltip(elem, "Please select an option.");
        }
      } else if (value === undefined || value === null || value === '') {
        elem.className = elem.className + ' _has_error';
        no_error = false;
        tooltip = create_tooltip(elem, "This field is required.");
      }
    }
    if (no_error && elem.name == 'email') {
      if (!value.match(/^[\+_a-z0-9-'&=]+(\.[\+_a-z0-9-']+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,})$/i)) {
        elem.className = elem.className + ' _has_error';
        no_error = false;
        tooltip = create_tooltip(elem, "Enter a valid email address.");
      }
    }
    if (no_error && /date_field/.test(elem.className)) {
      if (!value.match(/^\d\d\d\d-\d\d-\d\d$/)) {
        elem.className = elem.className + ' _has_error';
        no_error = false;
        tooltip = create_tooltip(elem, "Enter a valid date.");
      }
    }
    tooltip ? resize_tooltip(tooltip) : false;
    return no_error;
  };
  var needs_validate = function(el) {
        if(el.getAttribute('required') !== null){
            return true
        }
        if(el.name === 'email' && el.value !== ""){
            return true
        }
        return false
  };
  var validate_form = function(e) {
    var err = form_to_submit.querySelector('._form_error'), no_error = true;
    if (!submitted) {
      submitted = true;
      for (var i = 0, len = allInputs.length; i < len; i++) {
        var input = allInputs[i];
        if (needs_validate(input)) {
          if (input.type == 'text' || input.type == 'number' || input.type == 'time') {
            addEvent(input, 'blur', function() {
              this.value = this.value.trim();
              validate_field(this, true);
            });
            addEvent(input, 'input', function() {
              validate_field(this, true);
            });
          } else if (input.type == 'radio' || input.type == 'checkbox') {
            (function(el) {
              var radios = form_to_submit.elements[el.name];
              for (var i = 0; i < radios.length; i++) {
                addEvent(radios[i], 'click', function() {
                  validate_field(el, true);
                });
              }
            })(input);
          } else if (input.tagName == 'SELECT') {
            addEvent(input, 'change', function() {
              validate_field(this, true);
            });
          } else if (input.type == 'textarea'){
            addEvent(input, 'input', function() {
              validate_field(this, true);
            });
          }
        }
      }
    }
    remove_tooltips();
    for (var i = 0, len = allInputs.length; i < len; i++) {
      var elem = allInputs[i];
      if (needs_validate(elem)) {
        if (elem.tagName.toLowerCase() !== "select") {
          elem.value = elem.value.trim();
        }
        validate_field(elem) ? true : no_error = false;
      }
    }
    if (!no_error && e) {
      e.preventDefault();
    }
    resize_tooltips();
    return no_error;
  };
  addEvent(window, 'resize', resize_tooltips);
  addEvent(window, 'scroll', resize_tooltips);
    var _form_serialize = function(form){if(!form||form.nodeName!=="FORM"){return }var i,j,q=[];for(i=0;i<form.elements.length;i++){if(form.elements[i].name===""){continue}switch(form.elements[i].nodeName){case"INPUT":switch(form.elements[i].type){case"text":case"number":case"date":case"time":case"hidden":case"password":case"button":case"reset":case"submit":q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].value));break;case"checkbox":case"radio":if(form.elements[i].checked){q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].value))}break;case"file":break}break;case"TEXTAREA":q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].value));break;case"SELECT":switch(form.elements[i].type){case"select-one":q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].value));break;case"select-multiple":for(j=0;j<form.elements[i].options.length;j++){if(form.elements[i].options[j].selected){q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].options[j].value))}}break}break;case"BUTTON":switch(form.elements[i].type){case"reset":case"submit":case"button":q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].value));break}break}}return q.join("&")};
  var form_submit = function(e) {
    e.preventDefault();
    if (validate_form()) {
      // use this trick to get the submit button & disable it using plain javascript
      document.querySelector('#_form_1_submit').disabled = true;
            var serialized = _form_serialize(document.getElementById('_form_1_')).replace(/%0A/g, '\\n');
      var err = form_to_submit.querySelector('._form_error');
      err ? err.parentNode.removeChild(err) : false;
      _load_script('https://thecodefolioguy.activehosted.com/proc.php?' + serialized + '&jsonp=true');
    }
    return false;
  };
  addEvent(form_to_submit, 'submit', form_submit);
})();

</script>
        <!-- End ActiveCampaign Signup Form -->
    </div><!-- .inner -->
</section><!-- .widget -->

        

<section id="comments-area" class="comments-area comments-opened">  <!-- comments-opened class added to do insta-show, not delayed-show -->
    <h2 class="comments-title">Comments</h2>
    <div class="comments-inside">
        <div id="disqus_thread"></div>
    </div><!-- .comments-inside -->
    <!-- <div id="comments-overlay" class="comments-overlay">
        <a href="#" id="comments-show" class="comments-show">Show comments</a>
    </div> --><!-- .comments-overlay - removed because I don't like the click-to-load... -->
    <script type="text/javascript">
        var disqus_config = function () {
            // Replace PAGE_URL with your page's canonical URL variable
            this.page.url = 'https://codefol.io/posts/series-build-coding-course-deployment';

            // Replace PAGE_IDENTIFIER with your page's unique identifier variable
            this.page.identifier = 'https://codefol.io/posts/series-build-coding-course-deployment';
        };

        var disqus_shortname = 'rubymadscience';
        var disqus_developer = 0;
        (function () {
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = window.location.protocol + '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



        <section class="read-next inner">
            <h2 class="read-next-title">Read Next</h2>

                <article class="post">
                    <header class="post-header">
                        <h3 class="post-title"><a href="/posts/series-build-coding-course-subscriptions-and-profiles/">Let's Build Course Software: Subscriptions and Profiles</a></h3>
                        <p class="post-tags">
                                <a href='/tags/ruby/'>ruby</a>
                                <a href='/tags/rails/'>rails</a>
                                <a href='/tags/letsbuild/'>letsbuild</a>
                                <a href='/tags/rubymadscience/'>rubymadscience</a>
                        </p>
                    </header>
                        <a href="/posts/series-build-coding-course-subscriptions-and-profiles/" class="post-thumbnail">
                            <img src="/img/chimp_bear_pirate_studying_objects_aside.png" width="216" height="135" alt="Let's Build Course Software: Subscriptions and Profiles" />
                    </a>
                </article>
                <article class="post">
                    <header class="post-header">
                        <h3 class="post-title"><a href="/posts/series-build-coding-course-real-teaching/">Let's Build Course Software: Real Teaching and File-Based Models</a></h3>
                        <p class="post-tags">
                                <a href='/tags/ruby/'>ruby</a>
                                <a href='/tags/rails/'>rails</a>
                                <a href='/tags/letsbuild/'>letsbuild</a>
                                <a href='/tags/rubymadscience/'>rubymadscience</a>
                        </p>
                    </header>
                        <a href="/posts/series-build-coding-course-real-teaching/" class="post-thumbnail">
                            <img src="/img/RadioRepair_aside.png" width="216" height="162" alt="Let's Build Course Software: Real Teaching and File-Based Models" />
                    </a>
                </article>
                <article class="post">
                    <header class="post-header">
                        <h3 class="post-title"><a href="/posts/what-do-they-mean-when-they-ask-if-rails-is-dead/">What Do They Mean When They Ask if Rails is Dead?</a></h3>
                        <p class="post-tags">
                                <a href='/tags/video/'>video</a>
                                <a href='/tags/career/'>career</a>
                        </p>
                    </header>
                      <!-- Nothing here -->
                </article>
        </section><!-- .read-next -->
        <!-- has_key(prev) -->
    </main><!-- .site-main -->
</div><!-- .site-content -->



        <footer id="colophon" class="site-footer outer">
            <div class="site-footer-inside">
                <p class="social-links">
    <a href="https://ruby.social/@codefolio" target="_blank">
        <span class="fa-rss fa" aria-hidden="true"></span>
        <span class="screen-reader-text">Mastodon</span>
    </a>
    <a href="https://github.com/noahgibbs" target="_blank">
        <span class="fa-github fa" aria-hidden="true"></span>
        <span class="screen-reader-text">GitHub</span>
    </a>
    <a href="https://www.linkedin.com/in/noahgibbs" target="_blank">
        <span class="fa-linkedin fa" aria-hidden="true"></span>
        <span class="screen-reader-text">Linkedin</span>
    </a>
   <a rel="me" href="https://ruby.social/@codefolio">Mastodon</a>
</p>

                <p class="site-info">
                    <a href="#">Codefol.io</a> &copy; 2020 . Horace theme by
                    <a target="_blank" href="https://justgoodthemes.com/">JustGoodThemes</a>..
                </p>
                <p class="back-to-top">
                    <a id="top-button" class="top-button" href="#page">
                        <span class="icon-arrow-up" aria-hidden="true"></span>
                        <span class="screen-reader-text">Back to top</span>
                    </a>
                </p>
            </div><!-- .site-footer-inside -->
        </footer><!-- .site-footer -->
    </div><!-- .site -->
    <div id="site-overlay" class="site-overlay"></div>


        <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-30520713-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-30520713-1');
    </script>

    <!-- Javascript Assets -->
    <script src="/js/jquery-3.3.1.min.js"></script>
    <script src="/js/simple-lightbox.min.js"></script>
    <script src="/js/plugins.js"></script>
    <script src="/js/custom.js"></script>
    <script id="dsq-count-scr" src="//rubymadscience.disqus.com/count.js" async></script>
</body>

</html>